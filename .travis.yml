language: python

dist: xenial
services:
  - xvfb

python:
  - "3.5"
  - "3.6"
  - "3.7-dev"

env:
  global:
    - CC_TEST_REPORTER_ID=5b6a9ee40b0e80bc25f525a09c265bf0eb25833bea0b3140efa9b464bdab03cb

before_script: # configure a headless display to test plot generation
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
  - "export DISPLAY=:99.0"

before_install:
  - sudo apt-get update -yq
  - sudo apt-get install -qq python-numpy python-scipy python-matplotlib

install:
  - "pip install coverage==4.3.4"
  - "pip install pandas"
  - "pip install seaborn"

script:
  - "coverage run --source=opcsim setup.py test"

after_success:
  - coverage xml
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT